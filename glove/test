import tensorflow as tf

from word2vec.new_skip.SkipModelNS import SkipModelNS

# print(dataset)
FILE_PATH = open("/home/bachvarv/Abschlussarbeit/Corpus/corpus_small2.txt", 'r')
# file = open("/home/bachvarv/Abschlussarbeit/Corpus/corpus_small.txt", 'r')


model = SkipModelNS(10, 10)
model.compile(optimizer="adam",
              loss=tf.keras.losses.CategoricalCrossentropy(from_logits=True),
              metrics=['accuracy'])

tensorboard_callback = tf.keras.callbacks.TensorBoard(log_dir="logs")

# model.fit(dataset, epochs=1, callbacks=[tensorboard_callback])

weights = model.get_layer('glove_embedding').get_weights()

# print(weights)

# print(dataset[0])
# result = model(dataset[0])

# print(result)